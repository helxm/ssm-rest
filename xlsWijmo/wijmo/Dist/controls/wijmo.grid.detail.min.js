/*
    *
    * Wijmo Library 5.20162.188
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the Wijmo Commercial License.
    * sales@wijmo.com
    * http://wijmo.com/products/wijmo-5/license/
    *
    */
var __extends,wijmo;(function(n){var t;(function(t){var i;(function(i){'use strict';(function(n){n[n.Code=0]="Code";n[n.Selection=1]="Selection";n[n.ExpandSingle=2]="ExpandSingle";n[n.ExpandMulti=3]="ExpandMulti"})(i.DetailVisibilityMode||(i.DetailVisibilityMode={}));var r=i.DetailVisibilityMode,u=function(){function u(n){var t=this;this._mode=r.ExpandSingle;this._g=n;n.mergeManager=new i.DetailMergeManager(n);n.rowHeaders.hostElement.addEventListener('click',this._hdrClick.bind(this));n.formatItem.addHandler(this._formatItem,this);n.selectionChanged.addHandler(this._selectionChanged,this);n.resizedRow.addHandler(this._resizedRow,this);n.loadingRows.addHandler(function(){t.hideDetail()});n.draggingRow.addHandler(function(n,i){t.hideDetail(i.row)});n.formatItem.addHandler(function(n,t){if(t.panel==n.cells){var r=n.rows[t.row];r instanceof i.DetailRow&&(t.cell.style.left='0')}})}return Object.defineProperty(u.prototype,"grid",{get:function(){return this._g},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"detailVisibilityMode",{get:function(){return this._mode},set:function(t){t!=this._mode&&(this._mode=n.asEnum(t,r),this.hideDetail(),this._g.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"maxHeight",{get:function(){return this._maxHeight},set:function(t){this._maxHeight=n.asNumber(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"createDetailCell",{get:function(){return this._createDetailCellFn},set:function(t){this._createDetailCellFn=n.asFunction(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"disposeDetailCell",{get:function(){return this._disposeDetailCellFn},set:function(t){this._disposeDetailCellFn=n.asFunction(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"rowHasDetail",{get:function(){return this._rowHasDetailFn},set:function(t){this._rowHasDetailFn=n.asFunction(t,!0)},enumerable:!0,configurable:!0}),u.prototype.isDetailVisible=function(n){var t=this._g.rows;return(n=this._toIndex(n),t[n]instanceof i.DetailRow)?!0:n<t.length-1&&t[n+1]instanceof i.DetailRow?!0:!1},u.prototype.isDetailAvailable=function(n){var t=this._g.rows;return n=this._toIndex(n),this._hasDetail(n)},u.prototype.hideDetail=function(t){var r=this._g.rows,u;if(t==null){for(u=0;u<r.length;u++)r[u]instanceof i.DetailRow&&this.hideDetail(u);return}t=this._toIndex(t);!(r[t]instanceof i.DetailRow)&&t<r.length-1&&r[t+1]instanceof i.DetailRow&&t++;r[t]instanceof i.DetailRow&&(this.disposeDetailCell&&this.disposeDetailCell(r[t]),n.Control.disposeAll(r[t].detail),r.removeAt(t))},u.prototype.showDetail=function(n,t){var u,e,f,o,r;if(t===void 0&&(t=!1),u=this._g.rows,n=this._toIndex(n),!this.isDetailVisible(n)&&this._hasDetail(n)&&(e=new i.DetailRow(u[n]),e.detail=this._createDetailCell(u[n]),e.detail&&(u.insert(n+1,e),this._g.scrollIntoView(n,-1))),t){for(f=this._g.selection,o=!1,n>0&&u[n]instanceof i.DetailRow&&n--,r=0;r<u.length-1;r++)r!=n&&u[r+1]instanceof i.DetailRow&&(this.hideDetail(r),r<n&&n--,r<f.row&&(f.row--,f.row2--,o=!0));o&&this._g.select(f,!1)}},u.prototype._toIndex=function(i){return i instanceof t.Row&&(i=i.index),n.asNumber(i,!1,!0)},u.prototype._hdrClick=function(n){var u,i,f;(this._mode==r.ExpandMulti||this._mode==r.ExpandSingle)&&(u=this._g,i=u.hitTest(n),i.row>-1&&(f=u.rows[i.row],this.isDetailVisible(i.row)?this.hideDetail(i.row):(u.select(new t.CellRange(i.row,0,i.row,u.columns.length-1)),this.showDetail(i.row,this._mode==r.ExpandSingle)),n.preventDefault()))},u.prototype._selectionChanged=function(n){var t=this;this._mode==r.Selection&&(this._toSel&&clearTimeout(this._toSel),this._toSel=setTimeout(function(){n.selection.row>-1?t.showDetail(n.selection.row,!0):t.hideDetail()},300))},u.prototype._formatItem=function(t,u){var e=this._g,f=u.panel.rows[u.row],h,o,s,c;u.panel==e.cells&&f instanceof i.DetailRow&&f.detail!=null&&(n.addClass(u.cell,'wj-detail'),u.cell.textContent='',u.cell.style.textAlign='',u.cell.appendChild(f.detail),f.height==null?(n.Control.refreshAll(u.cell),h=getComputedStyle(u.cell),o=f.detail.scrollHeight+parseInt(h.paddingTop)+parseInt(h.paddingBottom),this._maxHeight>0&&o>this._maxHeight&&(o=this._maxHeight),f.height=o,f.detail.style.height||(f.detail.style.height='100%'),s=f.detail.querySelector('.wj-flexgrid'),s&&!s.style.height&&(s.style.height='100%')):setTimeout(function(){n.Control.refreshAll(f.detail)}));(this._mode==r.ExpandMulti||this._mode==r.ExpandSingle)&&u.panel==e.rowHeaders&&u.col==0&&this._hasDetail(u.row)&&(c=u.row<e.rows.length-1&&e.rows[u.row+1]instanceof i.DetailRow,u.cell.innerHTML=c?'<span class="wj-glyph-minus"></span>':'<span class="wj-glyph-plus"></span>')},u.prototype._resizedRow=function(t,r){var u=r.panel.rows[r.row];u instanceof i.DetailRow&&u.detail&&n.Control.refreshAll(u.detail)},u.prototype._hasVisibleDetail=function(n){return n instanceof i.DetailRow||n instanceof t.GroupRow||n instanceof t._NewRowTemplate?!1:!0},u.prototype._hasDetail=function(t){return n.isFunction(this._rowHasDetailFn)?this._rowHasDetailFn(this._g.rows[t]):!0},u.prototype._createDetailCell=function(n,t){return this.createDetailCell?this.createDetailCell(n,t):null},u}();i.FlexGridDetailProvider=u})(i=t.detail||(t.detail={}))})(t=n.grid||(n.grid={}))})(wijmo||(wijmo={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t;(function(n){var t;(function(t){'use strict';var i=function(i){function r(n){i.call(this,n)}return __extends(r,i),r.prototype.getMergedRange=function(r,u,f,e){e===void 0&&(e=!0);switch(r.cellType){case n.CellType.Cell:if(r.rows[u]instanceof t.DetailRow)return new n.CellRange(u,0,u,r.columns.length-1);break;case n.CellType.RowHeader:if(r.rows[u]instanceof t.DetailRow)return new n.CellRange(u-1,f,u,f);if(u<r.rows.length-1&&r.rows[u+1]instanceof t.DetailRow)return new n.CellRange(u,f,u+1,f)}return i.prototype.getMergedRange.call(this,r,u,f,e)},r}(n.MergeManager);t.DetailMergeManager=i})(t=n.detail||(n.detail={}))})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={}));__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t;(function(n){var t;(function(t){'use strict';var i=function(n){function t(){n.call(this);this.isReadOnly=!0}return __extends(t,n),Object.defineProperty(t.prototype,"detail",{get:function(){return this._detail},set:function(n){this._detail=n},enumerable:!0,configurable:!0}),t}(n.Row);t.DetailRow=i})(t=n.detail||(n.detail={}))})(t=n.grid||(n.grid={}))}(wijmo||(wijmo={}))