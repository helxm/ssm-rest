/*
    *
    * Wijmo Library 5.20162.188
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the Wijmo Commercial License.
    * sales@wijmo.com
    * http://wijmo.com/products/wijmo-5/license/
    *
    */
var wijmo;(function(n){var t;(function(t){var i;(function(i){'use strict';var r=function(){function i(){}return i.export=function(t,i){console.error('** The "FlexGridXlsxConverter.export" method is deprecated. Please use the "FlexGridXlsxConverter.save" method instead.');var r=this.toWorkbookOM(t,i);return n.xlsx.XlsxConverter.export(r)},i.import=function(t,i,r,u){console.error('** The "FlexGridXlsxConverter.import" method is deprecated. Please use the "FlexGridXlsxConverter.load" method instead.');var f=n.xlsx.XlsxConverter.import(t);this.fromWorkbookOM(f,i,r,u)},i.toWorkbookOM=function(t,i){console.error('** The "FlexGridXlsxConverter.toWorkbookOM" method is deprecated. Please use the "FlexGridXlsxConverter.save" method instead.');var r={sheets:[],creator:'',created:new Date,lastModifiedBy:'',modified:new Date,activeWorksheet:0},u,f;if(i&&i.activeWorksheet!=null&&i.activeWorksheet>0&&(r.activeWorksheet=i.activeWorksheet),n.isArray(t))for(u=0;u<t.length;u++)f=t[u],this._exportFlexGrid(f,r,i);else this._exportFlexGrid(t,r,i);return r},i.fromWorkbookOM=function(i,r,u,f){console.error('** The "FlexGridXlsxConverter.fromWorkbookOM" method is deprecated. Please use the "FlexGridXlsxConverter.load" method class instead.');var ri=u?u.includeColumnHeader:!0,y=u?u.includeColumnHeader:!0,kt=1,g=0,e=0,h=0,it,rt,p,ut,w,b,ft,yt,nt,dt,s,l,gt,k,et,c,ot,st,ni,pt,a,ht,d,v,ti,ct,o,wt,bt,lt,ii,tt,at=!1,vt={};if(r.itemsSource=null,r.columns.clear(),r.rows.clear(),r.frozenColumns=0,r.frozenRows=0,i.sheets.length!==0)for(f&&(kt=i.sheets.length);g<kt;g++){for(wt={},bt={},h=0,ut=[],lt=[],l=i.sheets[g],ri&&(h=1,l.rows.length<=1&&(y=!1,h=0),yt=l.rows[0]),k=this._getColumnCount(l.rows),gt=this._getRowCount(l.rows,k),ni=l.summaryBelow,g>0&&(ti=document.createElement('div'),r=new t.FlexGrid(ti)),p=l.columns||l.cols,e=0;e<k;e++)r.columns.push(new t.Column),!p[e]||(isNaN(+p[e].width)||(r.columns[e].width=+p[e].width),p[e].visible||p[e].visible==undefined||(r.columns[e].visible=!!p[e].visible));for(;h<gt;h++){if(et=!1,s=l.rows[h],s)for(ot=h+1;ot<l.rows.length;)if(st=l.rows[ot],st){(isNaN(s.groupLevel)&&!isNaN(st.groupLevel)||!isNaN(s.groupLevel)&&s.groupLevel<st.groupLevel)&&(et=!0);break}else ot++;for(et&&!ni?(a&&(a.isCollapsed=at),a=new t.GroupRow,at=s.collapsed==null?!1:s.collapsed,a.level=isNaN(s.groupLevel)?0:s.groupLevel,vt[a.level]=at,this._checkParentCollapsed(vt,a.level)&&a._setFlag(t.RowColFlags.ParentCollapsed,!0),r.rows.push(a)):(pt=new t.Row,s&&this._checkParentCollapsed(vt,s.groupLevel)&&pt._setFlag(t.RowColFlags.ParentCollapsed,!0),r.rows.push(pt)),!s||!s.height||isNaN(s.height)||(r.rows[y?h-1:h].height=s.height),e=0;e<k;e++)if(s){if(c=s.cells[e],v=c?c.formula:undefined,v&&v[0]!=='='&&(v='='+v),v=v?this._parseToFlexSheetFormula(v):undefined,r.setCellData(y?h-1:h,e,v&&f?v:this._getItemValue(c)),!et&&c&&c.value!=null&&c.value!==''&&this._setColumn(ut,e,c),ct=h*k+e,o=c?c.style:undefined,o){if(ii=this._getItemType(c),o.hAlign)tt=n.xlsx.Workbook._parseHAlignToString(n.asEnum(o.hAlign,n.xlsx.HAlign));else switch(ii){case n.DataType.Number:tt='right';break;case n.DataType.Boolean:tt='center';break;default:tt='left'}wt[ct]={fontWeight:o.font&&o.font.bold?'bold':'none',fontStyle:o.font&&o.font.italic?'italic':'none',textDecoration:o.font&&o.font.underline?'underline':'none',textAlign:tt,fontFamily:o.font&&o.font.family?o.font.family:'',fontSize:o.font&&o.font.size?o.font.size+'px':'',color:o.font&&o.font.color?o.font.color:'',backgroundColor:o.fill&&o.fill.color?o.fill.color:'',format:n.xlsx.Workbook._parseExcelFormat(c)};o.font&&lt.indexOf(o.font.family)===-1&&lt.push(o.font.family)}if(c&&n.isNumber(c.rowSpan)&&n.isNumber(c.colSpan))for(it=h;it<h+c.rowSpan;it++)for(rt=e;rt<e+c.colSpan;rt++)ct=it*k+rt,bt[ct]=new t.CellRange(h,e,h+c.rowSpan-1,e+c.colSpan-1)}else r.setCellData(y?h-1:h,e,''),this._setColumn(ut,e,undefined);!s||this._checkParentCollapsed(vt,s.groupLevel)||s.visible||s.visible==undefined||(r.rows[y?h-1:h].visible=s.visible)}for(a&&(a.isCollapsed=at),l.frozenPane&&(ht=l.frozenPane.columns,n.isNumber(ht)&&!isNaN(ht)&&(r.frozenColumns=ht),d=l.frozenPane.rows,n.isNumber(d)&&!isNaN(d)&&(r.frozenRows=y&&d>0?d-1:d)),e=0;e<r.columnHeaders.columns.length;e++)w=ut[e],b=r.columns[e],b.required=!1,y?(nt=yt?yt.cells[e]:undefined,nt&&nt.value?(dt=n.xlsx.Workbook._parseExcelFormat(nt),ft=n.Globalize.format(nt.value,dt)):ft=this._numAlpha(e)):ft=this._numAlpha(e),b.header=ft,w&&(w.dataType===n.DataType.Boolean&&(b.dataType=w.dataType),b.format=w.format,b.align=w.hAlign);f&&(r.wj_sheetInfo={name:l.name,visible:l.visible!==!1,styledCells:wt,mergedRanges:bt,fonts:lt});f&&g>0&&f.push(r)}},i.save=function(i,r,u){var w=new n.xlsx.Workbook,f=new n.xlsx.WorkSheet,d=new n.xlsx.WorkbookFrozenPane,it=r&&r.includeColumnHeaders!=null?r.includeColumnHeaders:!0,b=r&&r.includeRowHeaders!=null?r.includeRowHeaders:!1,a=r&&r.includeCellStyles!=null?r.includeCellStyles:!0,ft=r?r.activeWorksheet:null,s,v,y,p,h,o,e,g,l,nt,rt,k,tt=0,ut=0,c=0;if(g=i.wj_sheetInfo,f.name=r?r.sheetName:'',f.visible=r?r.sheetVisible!==!1:!0,f.style=new n.xlsx.WorkbookStyle,f.style.font=new n.xlsx.WorkbookFont,f.style.font.family='Arial',f.style.font.size=14,!g&&a&&(l=document.createElement('div'),l.style.visibility='hidden',i.hostElement.appendChild(l)),b){for(e=0;e<i.rowHeaders.columns.length;e++)y=i.rowHeaders.columns[e],p=this._getColumnSetting(y,i.columnHeaders.columns.defaultSize),h=new n.xlsx.WorkbookColumn,h._deserialize(p),f._addWorkbookColumn(h,e);c=e}if(it&&i.columnHeaders.rows.length>0){for(o=0;o<i.columnHeaders.rows.length;o++){if(o===0)for(e=0;e<i.columnHeaders.columns.length;e++)y=i.columnHeaders.columns[e],p=this._getColumnSetting(y,i.columnHeaders.columns.defaultSize),h=new n.xlsx.WorkbookColumn,h._deserialize(p),f._addWorkbookColumn(h,c+e);c=0;s={};v=new n.xlsx.WorkbookRow;b&&(c=this._parseFlexGridRowToSheetRow(i.topLeftCells,s,o,0,f.columns,a,l,!1,0));this._parseFlexGridRowToSheetRow(i.columnHeaders,s,o,c,f.columns,a,l,!1,0);s.cells.length>0&&(v._deserialize(s),f._addWorkbookRow(v,o))}ut=o}else for(e=0;e<i.columnHeaders.columns.length;e++)y=i.columnHeaders.columns[e],p=this._getColumnSetting(y,i.columnHeaders.columns.defaultSize),h=new n.xlsx.WorkbookColumn,h._deserialize(p),f._addWorkbookColumn(h,c+e);for(o=0;o<i.cells.rows.length;o++)c=0,s={},v=new n.xlsx.WorkbookRow,nt=i.rows[o],k=nt instanceof t.GroupRow,k&&(rt=n.tryCast(nt,t.GroupRow),tt=rt.level+1),b&&(c=this._parseFlexGridRowToSheetRow(i.rowHeaders,s,o,0,f.columns,a,l,k,tt)),this._parseFlexGridRowToSheetRow(i.cells,s,o,c,f.columns,a,l,k,tt),s.cells.length>0&&(v._deserialize(s),f._addWorkbookRow(v,ut+o));return d.rows=it?i.frozenRows+i.columnHeaders.rows.length:i.frozenRows,d.columns=b?i.frozenColumns+i.rowHeaders.columns.length:i.frozenColumns,f.frozenPane=d,w._addWorkSheet(f),!g&&a&&i.hostElement.removeChild(l),w.activeWorksheet=ft,u&&w.save(u),w},i.load=function(t,i,r){var u,f,e=this;if(i instanceof Blob)f=new FileReader,f.onload=function(){var i=n.xlsx.Workbook._base64EncArr(new Uint8Array(f.result));u=new n.xlsx.Workbook;u.load(i);e._loadToFlexGrid(t,u,r)},f.readAsArrayBuffer(i);else if(i instanceof n.xlsx.Workbook)e._loadToFlexGrid(t,i,r);else{if(i instanceof ArrayBuffer)i=n.xlsx.Workbook._base64EncArr(new Uint8Array(i));else if(!n.isString(i))throw'Invalid workbook.';u=new n.xlsx.Workbook;u.load(i);e._loadToFlexGrid(t,u,r)}},i._exportFlexGrid=function(i,r,u){var k=[],h=[],l={columns:[],rows:[],summaryBelow:!1},nt=u?u.includeColumnHeaders!=null?u.includeColumnHeaders:u.includeColumnHeader!=null?u.includeColumnHeader:!0:!0,w=u?u.includeRowHeaders!=null?u.includeRowHeaders:!1:!1,v=u?u.includeCellStyles!=null?u.includeCellStyles:u.needGetCellStyle!=null?u.needGetCellStyle:!0:!0,o,y,p,e,f,a,c,d,tt,b,g=0,it=0,s=0;if(a=i.wj_sheetInfo,l.name=a?a.name:'',l.visible=a?a.visible!==!1:!0,l.style={font:{family:'Arial',size:14}},!a&&v&&(c=document.createElement('div'),c.style.visibility='hidden',i.hostElement.appendChild(c)),w){for(f=0;f<i.rowHeaders.columns.length;f++)y=i.rowHeaders.columns[f],p=this._getColumnSetting(y,i.columnHeaders.columns.defaultSize),h[f]=p;s=f}if(nt&&i.columnHeaders.rows.length>0){for(e=0;e<i.columnHeaders.rows.length;e++){if(e===0)for(f=0;f<i.columnHeaders.columns.length;f++)y=i.columnHeaders.columns[f],p=this._getColumnSetting(y,i.columnHeaders.columns.defaultSize),h[s+f]=p;s=0;o={};w&&(s=this._parseFlexGridRowToSheetRow(i.topLeftCells,o,e,0,h,v,c,!1,0));this._parseFlexGridRowToSheetRow(i.columnHeaders,o,e,s,h,v,c,!1,0);o.cells.length>0&&(k[e]=o)}it=e}else for(f=0;f<i.columnHeaders.columns.length;f++)y=i.columnHeaders.columns[f],p=this._getColumnSetting(y,i.columnHeaders.columns.defaultSize),h[s+f]=p;for(l.columns=h,e=0;e<i.cells.rows.length;e++)s=0,o={},d=i.rows[e],b=d instanceof t.GroupRow,b&&(tt=n.tryCast(d,t.GroupRow),g=tt.level+1),w&&(s=this._parseFlexGridRowToSheetRow(i.rowHeaders,o,e,0,h,v,c,b,g)),this._parseFlexGridRowToSheetRow(i.cells,o,e,s,h,v,c,b,g),o.cells.length>0&&(k[it+e]=o);l.rows=k;l.frozenPane={rows:nt?i.frozenRows+i.columnHeaders.rows.length:i.frozenRows,columns:w?i.frozenColumns+i.rowHeaders.columns.length:i.frozenColumns};r.sheets.push(l);!a&&v&&i.hostElement.removeChild(c)},i._loadToFlexGrid=function(i,r,u){var ni=u&&u.includeColumnHeaders!=null?u.includeColumnHeaders:!0,v=u&&u.includeColumnHeaders!=null?u.includeColumnHeaders:!0,at=u&&u.sheetIndex!=null&&!isNaN(u.sheetIndex)?u.sheetIndex:0,ti=u?u.sheetName:null,ii=u?u.sheetVisible:!0,ri=u&&(u.sheetIndex!=null&&!isNaN(u.sheetIndex)||u.sheetName!=null||u.sheetVisible!=null),f=0,s=0,nt,tt,y,it,p,w,rt,vt,d,bt,o,c,kt,b,ut,h,ft,et,dt,yt,l,ot,k,a,st,e,pt,wt,ht,gt,g,ct=!1,lt={};if(i.itemsSource=null,i.columns.clear(),i.rows.clear(),i.frozenColumns=0,i.frozenRows=0,pt={},wt={},s=0,it=[],ht=[],at<0||at>=r.sheets.length)throw'The sheet index option is out of the sheet range of current workbook.';if(c=r.sheets[at],c.rows!=null){for(ni&&(s=1,c.rows.length<=1&&(v=!1,s=0),vt=c.rows[0]),b=this._getColumnCount(c.rows),kt=this._getRowCount(c.rows,b),dt=c.summaryBelow,y=c.columns||c.cols,f=0;f<b;f++)i.columns.push(new t.Column),!y[f]||(isNaN(+y[f].width)||(i.columns[f].width=+y[f].width),y[f].visible||y[f].visible==undefined||(i.columns[f].visible=!!y[f].visible));for(;s<kt;s++){if(ut=!1,o=c.rows[s],o)for(ft=s+1;ft<c.rows.length;)if(et=c.rows[ft],et){(isNaN(o.groupLevel)&&!isNaN(et.groupLevel)||!isNaN(o.groupLevel)&&o.groupLevel<et.groupLevel)&&(ut=!0);break}else ft++;for(ut&&!dt?(l&&(l.isCollapsed=ct),l=new t.GroupRow,ct=o.collapsed==null?!1:o.collapsed,l.level=isNaN(o.groupLevel)?0:o.groupLevel,lt[l.level]=ct,this._checkParentCollapsed(lt,l.level)&&l._setFlag(t.RowColFlags.ParentCollapsed,!0),i.rows.push(l)):(yt=new t.Row,o&&this._checkParentCollapsed(lt,o.groupLevel)&&yt._setFlag(t.RowColFlags.ParentCollapsed,!0),i.rows.push(yt)),!o||!o.height||isNaN(o.height)||(i.rows[v?s-1:s].height=o.height),f=0;f<b;f++)if(o){if(h=o.cells[f],a=h?h.formula:undefined,a&&a[0]!=='='&&(a='='+a),a=a?this._parseToFlexSheetFormula(a):undefined,i.setCellData(v?s-1:s,f,a&&ri?a:this._getItemValue(h)),ut||this._setColumn(it,f,h),st=s*b+f,e=h?h.style:undefined,e){if(gt=this._getItemType(h),e.hAlign)g=n.xlsx.Workbook._parseHAlignToString(n.asEnum(e.hAlign,n.xlsx.HAlign));else switch(gt){case n.DataType.Number:g='right';break;case n.DataType.Boolean:g='center';break;default:g='left'}pt[st]={fontWeight:e.font&&e.font.bold?'bold':'none',fontStyle:e.font&&e.font.italic?'italic':'none',textDecoration:e.font&&e.font.underline?'underline':'none',textAlign:g,fontFamily:e.font&&e.font.family?e.font.family:'',fontSize:e.font&&e.font.size?e.font.size+'px':'',color:e.font&&e.font.color?e.font.color:'',backgroundColor:e.fill&&e.fill.color?e.fill.color:'',format:n.xlsx.Workbook._parseExcelFormat(h)};e.font&&ht.indexOf(e.font.family)===-1&&ht.push(e.font.family)}if(h&&n.isNumber(h.rowSpan)&&h.rowSpan>0&&n.isNumber(h.colSpan)&&h.colSpan>0&&(h.rowSpan>1||h.colSpan>1))for(nt=s;nt<s+h.rowSpan;nt++)for(tt=f;tt<f+h.colSpan;tt++)st=nt*b+tt,wt[st]=new t.CellRange(s,f,s+h.rowSpan-1,f+h.colSpan-1)}else i.setCellData(v?s-1:s,f,''),this._setColumn(it,f,undefined);!o||this._checkParentCollapsed(lt,o.groupLevel)||o.visible||o.visible==undefined||(i.rows[v?s-1:s].visible=o.visible)}for(l&&(l.isCollapsed=ct),c.frozenPane&&(ot=c.frozenPane.columns,n.isNumber(ot)&&!isNaN(ot)&&(i.frozenColumns=ot),k=c.frozenPane.rows,n.isNumber(k)&&!isNaN(k)&&(i.frozenRows=v&&k>0?k-1:k)),f=0;f<i.columnHeaders.columns.length;f++)p=it[f],w=i.columns[f],w.required=!1,v?(d=vt?vt.cells[f]:undefined,d&&d.value?(bt=n.xlsx.Workbook._parseExcelFormat(d),rt=n.Globalize.format(d.value,bt)):rt=this._numAlpha(f)):rt=this._numAlpha(f),w.header=rt,p&&(p.dataType===n.DataType.Boolean&&(w.dataType=p.dataType),w.format=p.format,w.align=p.hAlign);i.wj_sheetInfo={name:ti||c.name,visible:ii===!0?!0:c.visible!==!1,styledCells:pt,mergedRanges:wt,fonts:ht}}},i._parseFlexGridRowToSheetRow=function(t,i,r,u,f,e,o,s,h){var b,l,ft,c,a,v,g,it,nt,k,ot,y,p,rt,et,tt,w,ht=!1,ut,st,d;for(b=t.grid,tt=b.wj_sheetInfo,l=t.rows[r],i.cells||(i.cells=[]),i.visible=l.isVisible,i.height=l.renderHeight||t.rows.defaultSize,i.groupLevel=s?h-1:h,s&&(i.collapsed=l.isCollapsed),(l.constructor===n.grid.Row||l.constructor===n.grid._NewRowTemplate||n.grid.detail&&l.constructor===n.grid.detail.DetailRow)&&(ht=!0),c=0;c<t.columns.length;c++)if(et=1,rt=1,d=!1,p=null,tt&&t===b.cells?(ot=r*t.columns.length+c,tt.mergedRanges&&(p=tt.mergedRanges[ot]),tt.styledCells&&(y=tt.styledCells[ot])):e&&(y=this._getCellStyle(t,o,r,c)||{}),p||(p=b.getMergedRange(t,r,c,!1)),p?r===p.topRow&&c===p.leftCol&&(rt=p.bottomRow-p.topRow+1,et=p.rightCol-p.leftCol+1,d=!0):d=!0,ft=f[c+u],ht||s?(v=d?t.getCellData(r,c,!0):null,g=d?t.getCellData(r,c,!1):null,nt=!1,v&&n.isString(v)&&v.length>1&&v[0]==='='&&(nt=!0),w=n.isDate(g),a=y&&y.format?n.xlsx.Workbook._parseCellFormat(y.format,w):ft.style.format,a||(w?a='m/d/yyyy':n.isNumber(g)&&!t.columns[c].dataMap?a=n.isInt(g)?'#,##0':'#,##0.00':nt?(k=v.toLowerCase(),k==='=now()'?(a='m/d/yyyy h:mm',w=!0):k==='=today()'||k.substring(0,k.indexOf('('))==='=date'?(a='m/d/yyyy',w=!0):k.substring(0,k.indexOf('('))==='=time'&&(a='h:mm AM/PM',w=!0)):a='General')):(v=d?b.columnHeaders.getCellData(0,c,!0):null,a='General'),t===b.cells&&s&&l.hasChildren&&c===b.columns.firstVisibleIndex){if(v?it=v:d&&(ut=l.dataItem&&l.dataItem.groupDescription?l.dataItem.groupDescription.propertyName:'',st=b.columns.getColumn(ut),st&&(ut=st.header),it=ut?ut+': '+l.dataItem.name+' ('+l.dataItem.items.length+' items)':''),it==null&&!y)continue;w=n.isDate(it);i.cells[u+c]={value:it,isDate:w,formula:nt?this._parseToExcelFormula(v,w):null,colSpan:et,rowSpan:rt,style:this._extend(this._parseCellStyle(y),{format:a,font:{bold:!0},hAlign:n.xlsx.HAlign.Left,indent:h-1})}}else i.cells[u+c]={value:nt?undefined:a==='General'?v:g,isDate:w,formula:nt?this._parseToExcelFormula(v,w):null,colSpan:et,rowSpan:rt,style:this._extend(this._parseCellStyle(y),{format:a,hAlign:y&&y.textAlign?n.xlsx.Workbook._parseStringToHAlign(y.textAlign):n.isDate(g)&&ft.style.hAlign==null?n.xlsx.HAlign.Left:n.asEnum(ft.style.hAlign,n.xlsx.HAlign,!0),vAlign:rt>1?t===b.cells?n.xlsx.VAlign.Top:n.xlsx.VAlign.Center:null})};return u+c},i._parseCellStyle=function(t){var i=t&&t.fontSize?+t.fontSize.substring(0,t.fontSize.indexOf('px')):null;return isNaN(i)&&(i=null),{font:{bold:t&&t.fontWeight&&(t.fontWeight==='bold'||!isNaN(+t.fontWeight)&&+t.fontWeight>=700),italic:t&&t.fontStyle&&t.fontStyle==='italic',underline:t&&t.textDecoration&&t.textDecoration==='underline',family:t?this._parseToExcelFontFamily(t.fontFamily):null,size:i,color:t&&t.color?t.color:null},fill:{color:t&&t.backgroundColor?t.backgroundColor:null},borders:t?this._parseBorder(t):null,hAlign:t&&t.textAlign?n.xlsx.Workbook._parseStringToHAlign(t.textAlign):null}},i._parseBorder=function(n){var t,i;for(var r in{Left:0,Right:0,Top:0,Bottom:0})i=this._parseEgdeBorder(n,r),i&&(t||(t={}),t[r.toLowerCase()]=i);return t},i._parseEgdeBorder=function(t,i){var r,f='border'+i+'Color',u=t['border'+i+'Style'],e;if(u&&u!=='none'&&u!=='hidden'){r={};u=u.toLowerCase();switch(u){case'dotted':r.style=n.xlsx.BorderStyle.Dotted;break;case'dashed':r.style=n.xlsx.BorderStyle.Dashed;break;case'double':r.style=n.xlsx.BorderStyle.Double;break;default:r.style=n.xlsx.BorderStyle.Thin}t[f]&&(e=new n.Color(t[f]),r.color=e.toString())}return r},i._parseToExcelFontFamily=function(n){var t;return n?(t=n.split(','),t&&t.length>0&&(n=t[0].replace(/\"|\'/g,''))):n='Arial',n},i._parseToExcelFormula=function(t,i){var u=t.substring(1,t.indexOf('(')).toLowerCase(),r;switch(u){case'ceiling':case'floor':t=t.substring(0,t.lastIndexOf(')'))+', 1)';break;case'text':r=t.substring(t.lastIndexOf(','),t.lastIndexOf('\"'));r=n.xlsx.Workbook._parseCellFormat(r.substring(r.lastIndexOf('\"')+1),i);t=t.substring(0,t.lastIndexOf(',')+1)+'\"'+r+'\")'}return t},i._parseToFlexSheetFormula=function(t){var u=t.substring(1).match(/\W+(\w+)\(/),r,f,e,o,i;f=u&&u.length===2?u[1]:t.substring(1,t.indexOf('('));e=t.indexOf(f);switch(f.toLowerCase()){case'ceiling':case'floor':t=t.substring(0,t.lastIndexOf(','))+')';break;case'text':r=t.substring(e);i=r.substring(r.indexOf('\"'),r.lastIndexOf('\"'));i=i.substring(i.lastIndexOf('\"')+1);o=i.indexOf('0')>-1?0:'';i=n.xlsx.Workbook._parseExcelFormat({value:o,style:{format:i}});i=i.replace(/m+/g,function(n){return n.toUpperCase()}).replace(/Y+/g,function(n){return n.toLowerCase()}).replace(/M+:?|:?M+/gi,function(n){return n.indexOf(':')>-1?n.toLowerCase():n});t=t.substring(0,e)+r.substring(0,r.indexOf('\"')+1)+i+'\")'}return t},i._getColumnSetting=function(t,i){var r=t.renderWidth;return r=r||i,{autoWidth:!0,width:r,visible:t.visible,style:{format:t.format?n.xlsx.Workbook._parseCellFormat(t.format,t.dataType===n.DataType.Date):'',hAlign:n.xlsx.Workbook._parseStringToHAlign(this._toExcelHAlign(t.getAlignment()))}}},i._toExcelHAlign=function(n){return(n=n?n.trim().toLowerCase():n,!n)?n:n.indexOf('center')>-1?'center':n.indexOf('right')>-1||n.indexOf('end')>-1?'right':n.indexOf('justify')>-1?'justify':'left'},i._getColumnCount=function(t){for(var f=0,i=0,r,u=0;u<t.length;u++)r=t[u]&&t[u].cells?t[u].cells:[],r&&r.length>0&&(i=r.length,n.isInt(r[i-1].colSpan)&&r[i-1].colSpan>1&&(i=i+r[i-1].colSpan-1),i>f&&(f=i));return f},i._getRowCount=function(t,i){for(var f=t.length,u=f-1,o=0,e,s,r;o<i;o++)n:for(;u>=0;u--)if(e=t[u],s=e&&e.cells?e.cells:[],r=s[o],r&&(r.value!=null&&r.value!==''||n.isInt(r.rowSpan)&&r.rowSpan>1)){n.isInt(r.rowSpan)&&r.rowSpan>1&&u+r.rowSpan>f&&(f=u+r.rowSpan);break n}return f},i._numAlpha=function(n){var t=Math.floor(n/26)-1;return(t>-1?this._numAlpha(t):'')+String.fromCharCode(65+n%26)},i._getItemType=function(t){return t===undefined||t===null||t.value===undefined||t.value===null||isNaN(t.value)?undefined:n.getType(t.value)},i._setColumn=function(t,i,r){var f,e,o,u=t[i];u?(f=this._getItemType(r),u.dataType!==f&&u.dataType===n.DataType.Boolean&&f!==n.DataType.Boolean&&(u.dataType=f),r&&r.value!=null&&r.value!==''&&(e=n.xlsx.Workbook._parseExcelFormat(r),e&&u.format!==e&&e!=='General'&&(u.format=e)),r&&r.style&&r.style.hAlign&&(o=n.xlsx.Workbook._parseHAlignToString(n.asEnum(r.style.hAlign,n.xlsx.HAlign))),o||f!==n.DataType.Number||(o='right'),u.hAlign=o):t[i]={dataType:this._getItemType(r),format:n.xlsx.Workbook._parseExcelFormat(r),hAlign:''}},i._getItemValue=function(t){if(t===undefined||t===null||t.value===undefined||t.value===null)return undefined;var i=t.value;return n.isNumber(i)&&isNaN(i)?'':i instanceof Date&&isNaN(i.getTime())?'':i},i._getCellStyle=function(n,t,i,r){try{this._resetCellStyle(t);n.grid.cellFactory.updateCell(n,i,r,t)}catch(u){return undefined}return window.getComputedStyle(t)},i._resetCellStyle=function(n){for(var t in n.style)typeof n.style[t]=='string'&&isNaN(+t)&&(n.style[t]='')},i._extend=function(t,i){var r,u;for(r in i)u=i[r],n.isObject(u)&&t[r]?n.copy(t[r],u):t[r]=u;return t},i._checkParentCollapsed=function(n,t){var i=!1;return Object.keys(n).forEach(function(r){n[r]===!0&&i===!1&&!isNaN(t)&&+r<t&&(i=!0)}),i},i}();i.FlexGridXlsxConverter=r})(i=t.xlsx||(t.xlsx={}))})(t=n.grid||(n.grid={}))})(wijmo||(wijmo={}))